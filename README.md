# delphinpro.ru

## Документация

  - [Example](docs/empty.md)

## Разработка / сборка проекта

### Подготовка

Установить LTS версию NodeJS ([Скачать NodeJS, v10.16 или выше](https://nodejs.org/en/download/))

Установить глобально пакеты `gulp` (^4.0), `webpack-cli` (^3.3):
```bash
npm install -g gulp webpack-cli
```

Установить зависимости проекта
```bash
npm install
```

Запустить необходимую сборку или dev-сервер

```bash
# Examples:
npm run start
npm run build:production
```

### Сборка и dev-server

Для настройки выполнения необходимых задач отредактируйте задачи `default` и `build` в файле `gulpfile.js`

### Npm скрипты

| Скрипт              | Описание
|                 ---:|:---
| `start`             | Сборка проекта, запуск сервера разработки и слежения.
| `build:production`  | Сборка и минификация выходных файлов
| `build:development` | Сборка без минификации выходных файлов.
| `build:dist`        | Сборка проекта в отдельную папку. Выходные файлы объединяются и минифицируются.
| `clean`             | Очистка сборки, исключая элементы, указанные в опции `exclude` (_gulp.config.js_).
| `dev-tools`         | Заглавная страница для просмотра вёрстки и плавающая панель для наложения макета на страницу (pixel-perfect) и включения сетки.

### Gulp-задачи

_Задачи сборки следует запускать с соответствущими переменными окружения. Эти переменные уже установлены, если задача запускается через `npm run`._

| Задача          | Описание
|             ---:|:---
| `default`       | Сборка проекта, запуск сервера разработки и слежения.
| `build`         | Сборка проекта
| `dist`          | Сборка проекта в отдельную папку. Выходные файлы объединяются и минифицируются.
| `clean`         | Очистка сборки, исключая элементы, указанные в опции `exclude` (_gulp.config.js_).
| `clean:preview` | Предпросмотр того, что будет удалено при очистке.
| `copy`          | Копирование служебных файлов в сборку. По умолчанию это содержимое папки *source/assets*. 
| `scss`          | Компиляция стилей.
| `twig`          | Компиляция разметки страниц.
| `images`        | Оптимизация и копирование изображений.
| `fonts`         | Копирование шрифтов.
| `sprite:svg`    | Сборка svg-спрайтов.
| `webpack`       | Компиляция javascript-кода с использованием webpack.
| `webpack:watch` | Запуск webpack в режиме слежения.
| `dev-tools`     | Заглавная страница для просмотра вёрстки и плавающая панель для наложения макета на страницу (pixel-perfect) и включения сетки.
| `watch`         | Запуск отслеживания изменений в исходных файлах.
| `serve`         | Запуск сервера.
| `nop`           | Пустая задача, для внутренних целей.

### Конфигурация

Основная конфигурация сборщика определяется в файле `gulp.config.js`

| Переменная             |                | Описание
|:---                    |:---            |:---
| `_serverPort`          |  `3000`        | Порт, на котором будет запущен локальный dev-сервер.
| `_useProxy`            | `false`        | Использовать проксирование с другого сервера.
| `_localDomain`         | `''`           | Домен для проксирования.
| `_browsers`            |  `['chrome']`  | Браузеры, в которых будет открываться проект при старте.
| `root.main`            |  `__dirname`   | Корневая директория проекта. 
| `root.src`             |  `source`      | Корневая директория исходников. 
| `root.build`           |  `public_html` | Корневая директория билда. Здесь же будет запущен dev-сервер.
| `root.dist` | `public_html/design/dist` | Директория для отдельной dist сборки 
| `root.static`          |   `design`     | Общая директория для статики. Сюда по-умолчанию собираются стили, скрипты, копируются шрифты и картинки и т.п.
| `root.temp`            |   `.tmp`       | Директория для временных файлов.
| `dist`                 |   `[]`         | Стратегия объединения файлов статики для dist сборки. См. описание в разделе ниже.
| `config.svgSpriteName` |   `sprite.svg` | Имя выходного файла с символьными спрайтами 
| `config.svgSpritePath` |   `/design/`   | URL до файла спрайтов. Используется в функции svgIcon (twig-template) для вывода иконки. 
